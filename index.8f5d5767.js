const e=new class{constructor(e){this.SIZE=4,this.score=0,this.status="playing",this.board=Array.from({length:this.SIZE},()=>Array(this.SIZE).fill(0))}_addRandomTile(){let e=[];for(let t=0;t<this.SIZE;t++)for(let r=0;r<this.SIZE;r++)0===this.board[t][r]&&e.push({row:t,col:r});if(0===e.length)return;let t=Math.floor(Math.random()*e.length),{row:r,col:s}=e[t],o=.9>Math.random()?2:4;this.board[r][s]=o}moveLeft(){let e=!1;this.board.forEach((t,r)=>{let s=[...t],o=t.filter(e=>0!==e);for(let e=0;e<o.length-1;e++)o[e]===o[e+1]&&(o[e]=o[e]+o[e+1],this.score+=o[e],o[e+1]=0,e++);let l=o.filter(e=>0!==e);for(;l.length<4;)l.push(0);s.some((e,t)=>e!==l[t])&&(e=!0),this.board[r]=l}),e&&this._addRandomTile()}moveRight(){let e=!1;this.board.forEach((t,r)=>{let s=[...t],o=[...t].reverse().filter(e=>0!==e);for(let e=0;e<o.length-1;e++)o[e]===o[e+1]&&(o[e]=o[e]+o[e+1],this.score+=o[e],o[e+1]=0,e++);let l=o.filter(e=>0!==e);for(;l.length<4;)l.push(0);l=l.reverse(),s.some((e,t)=>e!==l[t])&&(e=!0),this.board[r]=l}),e&&this._addRandomTile()}moveUp(){let e=!1,t=[[],[],[],[]];for(let e=0;e<this.board.length;e++)for(let r=0;r<this.board[e].length;r++)t[r][e]=this.board[e][r];t.forEach((r,s)=>{let o=[...r],l=r.filter(e=>0!==e);for(let e=0;e<l.length-1;e++)l[e]===l[e+1]&&(l[e]=l[e]+l[e+1],this.score+=l[e],l[e+1]=0,e++);let a=l.filter(e=>0!==e);for(;a.length<4;)a.push(0);o.some((e,t)=>e!==a[t])&&(e=!0),t[s]=a});for(let e=0;e<4;e++)for(let r=0;r<4;r++)this.board[e][r]=t[r][e];e&&this._addRandomTile()}moveDown(){let e=!1,t=[[],[],[],[]];for(let e=0;e<this.board.length;e++)for(let r=0;r<this.board[e].length;r++)t[r][e]=this.board[e][r];t.forEach((r,s)=>{let o=[...r],l=[...r].reverse().filter(e=>0!==e);for(let e=0;e<l.length-1;e++)l[e]===l[e+1]&&(l[e]=l[e]+l[e+1],this.score+=l[e],l[e+1]=0,e++);let a=l.filter(e=>0!==e);for(;a.length<4;)a.push(0);a=a.reverse(),o.some((e,t)=>e!==a[t])&&(e=!0),t[s]=a});for(let e=0;e<4;e++)for(let r=0;r<4;r++)this.board[e][r]=t[r][e];e&&this._addRandomTile()}checkLose(){for(let e=0;e<4;e++)for(let t=0;t<4;t++)if(0===this.board[e][t])return!1;for(let e=0;e<4;e++)for(let t=0;t<4;t++)if(t<3&&this.board[e][t]===this.board[e][t+1]||e<3&&this.board[e][t]===this.board[e+1][t])return!1;return this.status="lose",!0}checkWin(){for(let e of this.board)for(let t of e)if(2048===t){this.status="win",document.querySelector(".message-win").classList.remove("hidden");return}}getScore(){return this.score}updateScore(){document.querySelector(".game-score").textContent=this.score}getState(){return this.board.map(e=>[...e])}getStatus(){return this.status}start(){this.score=0,this.status="playing",this.board=Array.from({length:this.SIZE},()=>Array(this.SIZE).fill(0)),this._addRandomTile(),this._addRandomTile();let e=document.querySelector(".start"),t=document.querySelector(".message-start");e.classList.remove("start"),e.classList.add("restart"),e.textContent="Restart",t.classList.add("hidden")}restart(){this.score=0,this.status="playing",this.board=Array.from({length:this.SIZE},()=>Array(this.SIZE).fill(0));let e=document.querySelector(".restart"),t=document.querySelector(".message-start"),r=document.querySelector(".message-lose"),s=document.querySelector(".message-win");r.classList.add("hidden"),t.classList.remove("hidden"),s.classList.add("hidden"),e.classList.add("start"),e.classList.remove("restart"),e.textContent="Start"}},t=document.querySelector(".button.start");function r(){let t=document.querySelectorAll(".field-cell");for(let r=0;r<4;r++)for(let s=0;s<4;s++){let o=4*r+s,l=e.board[r][s],a=t[o];a.textContent=0===l?"":l,a.className="field-cell",0!==l&&a.classList.add(`field-cell--${l}`)}}function s(){e.checkLose()&&document.querySelector(".message-lose").classList.remove("hidden")}function o(){e.checkWin()&&document.querySelector(".message-win").classList.remove("hidden")}t.addEventListener("click",()=>{t.classList.contains("restart")?e.restart():e.start(),r(),e.updateScore()}),document.addEventListener("keydown",t=>{"ArrowLeft"===t.key&&(e.moveLeft(),r(),e.updateScore(),s(),o()),"ArrowRight"===t.key&&(e.moveRight(),r(),e.updateScore(),s(),o()),"ArrowUp"===t.key&&(e.moveUp(),r(),e.updateScore(),s(),o()),"ArrowDown"===t.key&&(e.moveDown(),r(),e.updateScore(),s(),o())});
//# sourceMappingURL=index.8f5d5767.js.map
